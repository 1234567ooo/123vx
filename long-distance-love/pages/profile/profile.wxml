<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
  <view class="profile-card card">
    <view class="profile-header">
      <image class="profile-avatar"
             src="{{userInfo.avatarUrl || ''}}"
             mode="aspectFill"
             bindtap="changeAvatar"></image>
      <view class="profile-info">
        <text class="profile-name">{{userInfo.nickName || 'ç‚¹å‡»è®¾ç½®æ˜µç§°'}}</text>
        <text class="profile-status">{{userInfo.status || 'è®¾ç½®ä¸ªæ€§ç­¾å'}}</text>
      </view>
      <view class="edit-btn" bindtap="editProfile">
        <text class="edit-icon">âœï¸</text>
      </view>
    </view>
  </view>

  <!-- æƒ…ä¾£ä¿¡æ¯å¡ç‰‡ -->
  <view class="couple-card card">
    <view class="couple-header">
      <text class="couple-title">æƒ…ä¾£ä¿¡æ¯</text>
    </view>
    <view class="couple-content">
      <view class="couple-avatars">
        <view class="avatar-container">
          <image class="couple-avatar"
                 src="{{userInfo.avatarUrl || ''}}"
                 mode="aspectFill"></image>
          <text class="avatar-label">æˆ‘</text>
        </view>
        <view class="heart-connector">
          <text class="heart-icon heart-animation">ğŸ’•</text>
        </view>
        <view class="avatar-container">
          <image class="couple-avatar"
                 src="{{partnerInfo.avatarUrl || ''}}"
                 mode="aspectFill"></image>
          <text class="avatar-label">{{partnerInfo.nickName || 'TA'}}</text>
        </view>
      </view>
      
      <view class="couple-stats">
        <view class="stat-row">
          <text class="stat-label">ç›¸çˆ±å¼€å§‹</text>
          <text class="stat-value">{{relationshipDate || 'æœªè®¾ç½®'}}</text>
        </view>
        <view class="stat-row">
          <text class="stat-label">ä¸‹æ¬¡è§é¢</text>
          <text class="stat-value">{{nextMeetDate || 'æœªè®¾ç½®'}}</text>
        </view>
        <view class="stat-row">
          <text class="stat-label">ç›¸çˆ±å¤©æ•°</text>
          <text class="stat-value primary-color">{{loveDays}} å¤©</text>
        </view>
      </view>
      
      <button class="btn-secondary" bindtap="editCoupleInfo">ç¼–è¾‘æƒ…ä¾£ä¿¡æ¯</button>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-section">
    <view class="menu-group card">
      <view class="menu-item" bindtap="viewStatistics">
        <view class="menu-icon">ğŸ“Š</view>
        <text class="menu-text">çˆ±æƒ…ç»Ÿè®¡</text>
        <view class="menu-arrow">></view>
      </view>
      <view class="menu-item" bindtap="exportData">
        <view class="menu-icon">ğŸ“¤</view>
        <text class="menu-text">å¯¼å‡ºæ•°æ®</text>
        <view class="menu-arrow">></view>
      </view>
      <view class="menu-item" bindtap="importData">
        <view class="menu-icon">ğŸ“¥</view>
        <text class="menu-text">å¯¼å…¥æ•°æ®</text>
        <view class="menu-arrow">></view>
      </view>
    </view>

    <view class="menu-group card">
      <view class="menu-item" bindtap="setReminder">
        <view class="menu-icon">â°</view>
        <text class="menu-text">æé†’è®¾ç½®</text>
        <view class="menu-arrow">></view>
      </view>
      <view class="menu-item" bindtap="privacySettings">
        <view class="menu-icon">ğŸ”’</view>
        <text class="menu-text">éšç§è®¾ç½®</text>
        <view class="menu-arrow">></view>
      </view>
      <view class="menu-item" bindtap="themeSettings">
        <view class="menu-icon">ğŸ¨</view>
        <text class="menu-text">ä¸»é¢˜è®¾ç½®</text>
        <view class="menu-arrow">></view>
      </view>
    </view>

    <view class="menu-group card">
      <view class="menu-item" bindtap="aboutApp">
        <view class="menu-icon">â„¹ï¸</view>
        <text class="menu-text">å…³äºåº”ç”¨</text>
        <view class="menu-arrow">></view>
      </view>
      <view class="menu-item" bindtap="feedback">
        <view class="menu-icon">ğŸ’¬</view>
        <text class="menu-text">æ„è§åé¦ˆ</text>
        <view class="menu-arrow">></view>
      </view>
      <view class="menu-item" bindtap="shareApp">
        <view class="menu-icon">ğŸ“±</view>
        <text class="menu-text">åˆ†äº«åº”ç”¨</text>
        <view class="menu-arrow">></view>
      </view>
    </view>
  </view>
</view>

<!-- ç¼–è¾‘ä¸ªäººä¿¡æ¯æ¨¡æ€æ¡† -->
<view class="edit-modal" wx:if="{{showEditModal}}">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">ç¼–è¾‘ä¸ªäººä¿¡æ¯</text>
      <view class="modal-close" bindtap="closeEditModal">
        <text class="close-icon">âœ•</text>
      </view>
    </view>
    
    <view class="modal-body">
      <view class="input-group">
        <text class="input-label">æ˜µç§°</text>
        <input class="input-field" 
               placeholder="è¯·è¾“å…¥æ˜µç§°" 
               value="{{editData.nickName}}" 
               bindinput="onNickNameInput"/>
      </view>
      
      <view class="input-group">
        <text class="input-label">ä¸ªæ€§ç­¾å</text>
        <input class="input-field" 
               placeholder="å†™ä¸ªä¸ªæ€§ç­¾åå§" 
               value="{{editData.status}}" 
               bindinput="onStatusInput"/>
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="btn-secondary" bindtap="closeEditModal">å–æ¶ˆ</button>
      <button class="btn-primary" bindtap="saveProfile">ä¿å­˜</button>
    </view>
  </view>
</view>

<!-- ç¼–è¾‘æƒ…ä¾£ä¿¡æ¯æ¨¡æ€æ¡† -->
<view class="couple-modal" wx:if="{{showCoupleModal}}">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">ç¼–è¾‘æƒ…ä¾£ä¿¡æ¯</text>
      <view class="modal-close" bindtap="closeCoupleModal">
        <text class="close-icon">âœ•</text>
      </view>
    </view>
    
    <view class="modal-body">
      <view class="input-group">
        <text class="input-label">TAçš„æ˜µç§°</text>
        <input class="input-field" 
               placeholder="è¯·è¾“å…¥TAçš„æ˜µç§°" 
               value="{{coupleData.nickName}}" 
               bindinput="onPartnerNameInput"/>
      </view>
      
      <view class="input-group">
        <text class="input-label">æ‹çˆ±å¼€å§‹æ—¥æœŸ</text>
        <picker mode="date" 
                end="{{today}}" 
                value="{{coupleData.startDate}}" 
                bindchange="onStartDateChange">
          <view class="date-picker">
            <text class="date-text">{{coupleData.startDate || 'è¯·é€‰æ‹©æ—¥æœŸ'}}</text>
            <text class="picker-arrow">ğŸ“…</text>
          </view>
        </picker>
      </view>
      
      <view class="input-group">
        <text class="input-label">ä¸‹æ¬¡è§é¢æ—¥æœŸ</text>
        <picker mode="date" 
                start="{{today}}" 
                value="{{coupleData.meetDate}}" 
                bindchange="onMeetDateChange">
          <view class="date-picker">
            <text class="date-text">{{coupleData.meetDate || 'è¯·é€‰æ‹©æ—¥æœŸ'}}</text>
            <text class="picker-arrow">ğŸ“…</text>
          </view>
        </picker>
      </view>
      
      <view class="input-group">
        <text class="input-label">è§é¢åœ°ç‚¹</text>
        <input class="input-field" 
               placeholder="åœ¨å“ªé‡Œè§é¢å‘¢ï¼Ÿ" 
               value="{{coupleData.meetLocation}}" 
               bindinput="onMeetLocationInput"/>
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="btn-secondary" bindtap="closeCoupleModal">å–æ¶ˆ</button>
      <button class="btn-primary" bindtap="saveCoupleInfo">ä¿å­˜</button>
    </view>
  </view>
</view>

<!-- ç»Ÿè®¡ä¿¡æ¯æ¨¡æ€æ¡† -->
<view class="stats-modal" wx:if="{{showStatsModal}}">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">çˆ±æƒ…ç»Ÿè®¡</text>
      <view class="modal-close" bindtap="closeStatsModal">
        <text class="close-icon">âœ•</text>
      </view>
    </view>
    
    <scroll-view class="modal-body" scroll-y="true">
      <view class="stats-grid">
        <view class="stats-item">
          <text class="stats-number primary-color">{{statistics.loveDays}}</text>
          <text class="stats-label">ç›¸çˆ±å¤©æ•°</text>
        </view>
        <view class="stats-item">
          <text class="stats-number secondary-color">{{statistics.totalMessages}}</text>
          <text class="stats-label">èŠå¤©æ¶ˆæ¯</text>
        </view>
        <view class="stats-item">
          <text class="stats-number primary-color">{{statistics.diaryCount}}</text>
          <text class="stats-label">æ—¥è®°ç¯‡æ•°</text>
        </view>
        <view class="stats-item">
          <text class="stats-number secondary-color">{{statistics.photoCount}}</text>
          <text class="stats-label">ç…§ç‰‡æ•°é‡</text>
        </view>
        <view class="stats-item">
          <text class="stats-number primary-color">{{statistics.meetCount}}</text>
          <text class="stats-label">è§é¢æ¬¡æ•°</text>
        </view>
        <view class="stats-item">
          <text class="stats-number secondary-color">{{statistics.totalDays}}</text>
          <text class="stats-label">å¼‚åœ°å¤©æ•°</text>
        </view>
      </view>
      
      <view class="stats-chart">
        <text class="chart-title">æ¯æœˆæ´»è·ƒåº¦</text>
        <view class="chart-placeholder">
          <text class="chart-text">ğŸ“ˆ å›¾è¡¨åŠŸèƒ½å¼€å‘ä¸­...</text>
        </view>
      </view>
    </scroll-view>
  </view>
</view>